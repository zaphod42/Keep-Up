<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
		<title>Keep-Up</title>
		<link type="text/css" href="css/ui-lightness/jquery-ui-1.8.12.custom.css" rel="stylesheet" />	
		<script type="text/javascript" src="js/jquery-1.5.1.min.js"></script>
		<script type="text/javascript" src="js/jquery-ui-1.8.12.custom.min.js"></script>
		<script type="text/javascript" src="js/jquery.periodicalupdater.js"></script>
		<script type="text/javascript" src="js/json2.js"></script>
		<script type="text/javascript">
			$(function() {
				function startGame() {
					$.ajax({
						url: "/keep-up/resources/players",
						type: "PUT",
						contentType: "application/json",
						data: JSON.stringify({ name: $("#name").val(), url: $("#url").val() }),
						success: function() { $("#join-dialog").dialog("close"); }
					});
					return false;
				}
				
				$("button").button();
				$("#join").click(function() { $("#join-dialog").dialog("open"); });
				
				$("#join-dialog").dialog({ autoOpen: false });
				$("#join-dialog button").click(startGame);
				
				$.PeriodicalUpdater("/keep-up/resources/players", { method: "get", maxCalls: 0, autoStop: 0 }, function(playersResponse) {
					var board = $("#leaderboard");
					
					board.empty();
					
					$.each(playersResponse.players, function(index, player) {
						board.append($("<li></li>").text(player.name + " @ " + player.url));
					});
				});
			});
		</script>
	</head>
	<body>
	<h1>Welcome to Keep-Up!</h1>
	<button id="join">Join</button>
	
	<ul id="leaderboard">
	</ul>
	
	<div id="join-dialog" title="Join in and Keep Up!">
		<form>
			<div><label for="name">Name</label><input type="text" id="name"></div>
			<div><label for="url">URL</label><input type="text" id="url"></div>
			<button>Start</button>
		</form>
	</div>
	</body>
</html>


